# recommend_pattern Tool è©³ç´°è¨­è¨ˆæ›¸

> **WBSç•ªå·**: 3.1.6
> **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨­è¨ˆå®Œäº†
> **ä½œæˆæ—¥**: 2026-02-03
> **ä½œæˆè€…**: ashigaru5 (subtask_064)
> **é–¢é€£æ–‡æ›¸**: architecture.md Â§5.1 Tool 6, use-cases.md Â§UC8, 06_resource-uri-design.md

---

## ç›®æ¬¡

1. [æ¦‚è¦](#1-æ¦‚è¦)
2. [Toolå®šç¾©](#2-toolå®šç¾©)
3. [å…¥åŠ›ã‚¹ã‚­ãƒ¼ãƒ](#3-å…¥åŠ›ã‚¹ã‚­ãƒ¼ãƒ)
4. [å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒ](#4-å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒ)
5. [ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯](#5-ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯)
6. [RAGæ¤œç´¢+ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°è¨­è¨ˆ](#6-ragæ¤œç´¢ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°è¨­è¨ˆ)
7. [Nablarchãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚«ã‚¿ãƒ­ã‚°ã¨ã®é€£æº](#7-nablarchãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚«ã‚¿ãƒ­ã‚°ã¨ã®é€£æº)
8. [ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨è–¦ã®æ ¹æ‹ æç¤ºæ–¹é‡](#8-ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨è–¦ã®æ ¹æ‹ æç¤ºæ–¹é‡)
9. [MCP Toolç™»éŒ²ãƒ»ã‚¯ãƒ©ã‚¹è¨­è¨ˆ](#9-mcp-toolç™»éŒ²ã‚¯ãƒ©ã‚¹è¨­è¨ˆ)
10. [ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°](#10-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°)
11. [è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿](#11-è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿)

---

## 1. æ¦‚è¦

### 1.1 ç›®çš„

æœ¬è¨­è¨ˆæ›¸ã¯ã€Phase 3ã§æ–°è¦è¿½åŠ ã™ã‚‹ `recommend_pattern` MCP Toolã®è©³ç´°è¨­è¨ˆã‚’å®šç¾©ã™ã‚‹ã€‚
ã“ã®Toolã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦ä»¶è¨˜è¿°ã«åŸºã¥ã„ã¦Nablarchå›ºæœ‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¨è–¦ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã‚ã‚Šã€
11ç¨®ã®Nablarchãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸­ã‹ã‚‰æœ€é©ãªã‚‚ã®ã‚’ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ä»˜ãã§ææ¡ˆã™ã‚‹ã€‚

### 1.2 ã‚¹ã‚³ãƒ¼ãƒ—

- `recommend_pattern` Toolã®å…¥å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
- ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆ4ãƒ•ã‚§ãƒ¼ã‚ºï¼‰
- RAGã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆ`semantic_search`çµŒç”±ï¼‰ã¨ã®é€£æºãƒ•ãƒ­ãƒ¼
- `design-patterns.yaml`ï¼ˆ11ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã¨ã®é€£æºè¨­è¨ˆ
- Resource URIï¼ˆ`nablarch://pattern/{name}`ï¼‰ã¨ã®é–¢ä¿‚
- ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨è–¦ã®æ ¹æ‹ æç¤ºæ–¹é‡
- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã¨è¤‡æ•°å€™è£œã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ–¹å¼

### 1.3 èƒŒæ™¯

Nablarchã¯ç‹¬è‡ªã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆãƒãƒ³ãƒ‰ãƒ©ã‚­ãƒ¥ãƒ¼ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¯ãƒ©ã‚¹ã€Universal DAOç­‰ï¼‰ã‚’æŒã¤ã€‚
é–‹ç™ºè€…ãŒè¦ä»¶ã«å¯¾ã—ã¦é©åˆ‡ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é¸æŠã™ã‚‹ã«ã¯ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®è¨­è¨ˆæ€æƒ³ã¨å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç‰¹æ€§ã‚’
æ·±ãç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚æœ¬Toolã¯ã€è‡ªç„¶è¨€èªã®è¦ä»¶è¨˜è¿°ã‹ã‚‰Nablarchå›ºæœ‰ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¨è–¦ã—ã€
ãƒ‘ã‚¿ãƒ¼ãƒ³é¸æŠã®æ„æ€æ±ºå®šã‚’æ”¯æ´ã™ã‚‹ã€‚

---

## 2. Toolå®šç¾©

### 2.1 Toolæ¦‚è¦

| é …ç›® | å€¤ |
|------|-----|
| Toolå | `recommend_pattern` |
| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | `com.tis.nablarch.mcp.tools` |
| ã‚¯ãƒ©ã‚¹å | `RecommendPatternTool` |
| èª¬æ˜ | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦ä»¶ã«åŸºã¥ã„ã¦Nablarchå›ºæœ‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¨è–¦ã—ã€é©åˆåº¦ã‚¹ã‚³ã‚¢ã¨æ ¹æ‹ ã‚’æç¤ºã™ã‚‹ |
| ã‚«ãƒ†ã‚´ãƒª | æ¨è–¦ç³»Tool |

### 2.2 å¯¾å¿œãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

| UC | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å | æœ¬Toolã®å½¹å‰² |
|-----|-------------|-------------|
| UC8 | è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³æ¨å¥¨ | ãƒ¡ã‚¤ãƒ³Toolã€‚è¦ä»¶â†’ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨è–¦ã®å…¨å·¥ç¨‹ã‚’æ‹…å½“ |
| UC1 | ãƒãƒ³ãƒ‰ãƒ©ã‚­ãƒ¥ãƒ¼è‡ªå‹•è¨­è¨ˆ | design_handler_queueã®å‰æ®µã§ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³é¸æŠã‚’æ”¯æ´ |
| UC11 | åˆå­¦è€…å‘ã‘å­¦ç¿’æ”¯æ´ | å­¦ç¿’ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§Nablarchãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è§£èª¬ |

---

## 3. å…¥åŠ›ã‚¹ã‚­ãƒ¼ãƒ

### 3.1 ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å®šç¾©

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å‹ | å¿…é ˆ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|----------|-----|------|----------|------|
| `requirement` | string | â—‹ | â€” | ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨è–¦ã®ãŸã‚ã®è‡ªç„¶è¨€èªè¦ä»¶è¨˜è¿° |
| `app_type` | string | Ã— | null | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç¨®åˆ¥ï¼ˆweb, rest, batch, messagingï¼‰ |
| `constraints` | array[string] | Ã— | [] | è¿½åŠ ã®åˆ¶ç´„æ¡ä»¶ |
| `max_results` | integer | Ã— | 3 | è¿”å´ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³å€™è£œã®æœ€å¤§æ•°ï¼ˆ1ã€œ11ï¼‰ |

### 3.2 JSON Schema

```json
{
  "type": "object",
  "properties": {
    "requirement": {
      "type": "string",
      "description": "Natural language description of the requirement.",
      "minLength": 10
    },
    "app_type": {
      "type": "string",
      "enum": ["web", "rest", "batch", "messaging"]
    },
    "constraints": {
      "type": "array",
      "items": { "type": "string" }
    },
    "max_results": {
      "type": "integer",
      "minimum": 1,
      "maximum": 11,
      "default": 3
    }
  },
  "required": ["requirement"]
}
```

---

## 4. å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒ

### 4.1 ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ 

æœ¬Toolã¯Markdownå½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦çµæœã‚’è¿”å´ã™ã‚‹ã€‚

```json
{
  "query": "è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šãŒå¿…è¦...",
  "app_type": "web",
  "total_candidates": 3,
  "patterns": [
    {
      "rank": 1,
      "name": "multi-db-pattern",
      "display_name": "è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ‘ã‚¿ãƒ¼ãƒ³",
      "category": "data-access",
      "score": 0.87,
      "score_breakdown": {
        "keyword_match": 0.95,
        "category_match": 0.80,
        "app_type_fit": 1.00,
        "constraint_match": 0.70
      },
      "rationale": {
        "fit_reason": "è¤‡æ•°DBæ¥ç¶šã¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³åˆ†é›¢ã®è¦ä»¶ã«ç›´æ¥åˆè‡´ã™ã‚‹",
        "solution_summary": "DbConnectionManagementHandlerã‚’è¤‡æ•°å®šç¾©...",
        "trade_offs": ["æ¥ç¶šãƒ—ãƒ¼ãƒ«ãŒè¤‡æ•°å¿…è¦", "ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã®è¤‡é›‘ã•å¢—å¤§"]
      },
      "code_example": "<!-- XMLè¨­å®šä¾‹ -->...",
      "resource_uri": "nablarch://pattern/multi-db-pattern",
      "references": ["https://nablarch.github.io/..."]
    }
  ]
}
```

### 4.2 MCP Toolå¿œç­”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆMarkdownï¼‰

```markdown
## ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨è–¦çµæœ

**è¦ä»¶**: è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šãŒå¿…è¦ã§...
**ã‚¢ãƒ—ãƒªã‚¿ã‚¤ãƒ—**: web
**å€™è£œæ•°**: 3ä»¶

---

### ğŸ¥‡ ç¬¬1ä½: è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¹ã‚³ã‚¢: 87%ï¼‰

**ã‚«ãƒ†ã‚´ãƒª**: data-access
**é©åˆç†ç”±**: è¤‡æ•°DBæ¥ç¶šã¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³åˆ†é›¢ã®è¦ä»¶ã«ç›´æ¥åˆè‡´ã™ã‚‹

#### ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³æ¦‚è¦
DbConnectionManagementHandlerã‚’è¤‡æ•°å®šç¾©ã—ã€connectionNameã§æ¥ç¶šå…ˆã‚’åˆ†é›¢ã™ã‚‹ã€‚

#### ã‚³ãƒ¼ãƒ‰ä¾‹
```xml
<component class="nablarch.common.handler.DbConnectionManagementHandler">
  <property name="connectionFactory" ref="businessDbConnectionFactory"/>
  <property name="connectionName" value="business"/>
</component>
```

#### ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•
- âš  æ¥ç¶šãƒ—ãƒ¼ãƒ«ãŒè¤‡æ•°å¿…è¦ï¼ˆãƒªã‚½ãƒ¼ã‚¹æ¶ˆè²»å¢—ï¼‰
- âš  ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã®è¤‡é›‘ã•å¢—å¤§

**ğŸ“– è©³ç´°**: `nablarch://pattern/multi-db-pattern`
```

---

## 5. ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯

### 5.1 å…¨ä½“ãƒ•ãƒ­ãƒ¼ï¼ˆ4ãƒ•ã‚§ãƒ¼ã‚ºï¼‰

```
recommend_pattern Tool å‘¼ã³å‡ºã—
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: è¦ä»¶åˆ†æ                      â”‚
â”‚  - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º                      â”‚
â”‚  - ã‚«ãƒ†ã‚´ãƒªæ¨å®š                        â”‚
â”‚  - æ„å›³åˆ†é¡                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 2: å€™è£œåé›†                      â”‚
â”‚  - é™çš„çŸ¥è­˜ãƒ™ãƒ¼ã‚¹å‚ç…§                  â”‚
â”‚  - RAGæ¤œç´¢ï¼ˆPhase 2+ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 3: ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°                  â”‚
â”‚  - S1: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è‡´åº¦               â”‚
â”‚  - S2: ã‚«ãƒ†ã‚´ãƒªä¸€è‡´åº¦                 â”‚
â”‚  - S3: app_typeé©åˆåº¦                 â”‚
â”‚  - S4: åˆ¶ç´„ä¸€è‡´åº¦                     â”‚
â”‚  - S5: ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯é¡ä¼¼åº¦ï¼ˆPhase 2+ï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 4: ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”Ÿæˆ                â”‚
â”‚  - ã‚¹ã‚³ã‚¢é™é †ã‚½ãƒ¼ãƒˆ                   â”‚
â”‚  - æ ¹æ‹ ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ                   â”‚
â”‚  - Markdownãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Phase 1: è¦ä»¶åˆ†æ

| ã‚«ãƒ†ã‚´ãƒª | ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¾‹ |
|---------|------------|
| ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ | ãƒãƒ³ãƒ‰ãƒ©, ã‚­ãƒ¥ãƒ¼, ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ |
| ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ | DB, SQL, DAO, CRUD |
| ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³, å…¥åŠ›ãƒã‚§ãƒƒã‚¯, ãƒ•ã‚©ãƒ¼ãƒ  |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | èªè¨¼, CSRF, ãƒˆãƒ¼ã‚¯ãƒ³, äºŒé‡é€ä¿¡ |
| æ’ä»–åˆ¶å¾¡ | æ’ä»–, ãƒ­ãƒƒã‚¯, æ¥½è¦³, æ‚²è¦³ |

---

## 6. RAGæ¤œç´¢+ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°è¨­è¨ˆ

### 6.1 Phase 1 ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆé™çš„çŸ¥è­˜ã®ã¿ï¼‰

| ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ | è¨˜å· | é‡ã¿ | ç®—å‡ºæ–¹æ³• |
|-----------|------|------|---------|
| ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è‡´åº¦ | S1 | 0.40 | description/problem/solutionã¨ã®ä¸€è‡´ç‡ |
| ã‚«ãƒ†ã‚´ãƒªä¸€è‡´åº¦ | S2 | 0.25 | æ¨å®šã‚«ãƒ†ã‚´ãƒªã¨ã®ä¸€è‡´ |
| app_typeé©åˆåº¦ | S3 | 0.20 | applicable_app_typesã®ä¸€è‡´ |
| åˆ¶ç´„ä¸€è‡´åº¦ | S4 | 0.15 | constraintsã¨ã®ä¸€è‡´åº¦ |

```
Phase 1 Total Score = S1 Ã— 0.40 + S2 Ã— 0.25 + S3 Ã— 0.20 + S4 Ã— 0.15
```

### 6.2 Phase 2+ ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆRAGå¼·åŒ–ï¼‰

| ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ | è¨˜å· | é‡ã¿ | ç®—å‡ºæ–¹æ³• |
|-----------|------|------|---------|
| ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è‡´åº¦ | S1 | 0.25 | åŒä¸Š |
| ã‚«ãƒ†ã‚´ãƒªä¸€è‡´åº¦ | S2 | 0.20 | åŒä¸Š |
| app_typeé©åˆåº¦ | S3 | 0.15 | åŒä¸Š |
| åˆ¶ç´„ä¸€è‡´åº¦ | S4 | 0.15 | åŒä¸Š |
| ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯é¡ä¼¼åº¦ | S5 | 0.25 | semantic_searchã‚¹ã‚³ã‚¢ |

```
Phase 2+ Total Score = S1 Ã— 0.25 + S2 Ã— 0.20 + S3 Ã— 0.15 + S4 Ã— 0.15 + S5 Ã— 0.25
```

---

## 7. Nablarchãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚«ã‚¿ãƒ­ã‚°ã¨ã®é€£æº

### 7.1 ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚«ã‚¿ãƒ­ã‚°ï¼ˆdesign-patterns.yamlï¼‰

| # | ãƒ‘ã‚¿ãƒ¼ãƒ³å | ã‚«ãƒ†ã‚´ãƒª | å¯¾å¿œapp_type |
|---|-----------|---------|-------------|
| 1 | handler-queue-pattern | architecture | web, rest, batch, messaging |
| 2 | action-class-pattern | action | web, rest, batch |
| 3 | form-validation-pattern | validation | web, rest |
| 4 | universal-dao-pattern | data-access | web, rest, batch, messaging |
| 5 | sql-file-pattern | data-access | web, rest, batch, messaging |
| 6 | exclusive-control-pattern | data-access | web, rest |
| 7 | double-submit-prevention-pattern | security | web |
| 8 | interceptor-pattern | handler | web, rest |
| 9 | file-download-pattern | action | web |
| 10 | system-repository-pattern | architecture | web, rest, batch, messaging |
| 11 | multi-db-pattern | data-access | web, rest, batch |

### 7.2 Resource URIã¨ã®é–¢ä¿‚

å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ `nablarch://pattern/{name}` ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚

---

## 8. ãƒ‘ã‚¿ãƒ¼ãƒ³æ¨è–¦ã®æ ¹æ‹ æç¤ºæ–¹é‡

### 8.1 3å±¤æ§‹é€ ã®æ ¹æ‹ 

1. **ç¬¬1å±¤: é©åˆç†ç”±ï¼ˆfit_reasonï¼‰** - ãªãœã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¦ä»¶ã«é©åˆã™ã‚‹ã‹
2. **ç¬¬2å±¤: ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³æ¦‚è¦ï¼ˆsolution_summaryï¼‰** - ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è§£æ±ºç­–ã‚’è¦ç´„
3. **ç¬¬3å±¤: ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ï¼ˆtrade_offsï¼‰** - é©ç”¨æ™‚ã®æ³¨æ„ç‚¹ãƒ»åˆ¶ç´„

---

## 9. MCP Toolç™»éŒ²ãƒ»ã‚¯ãƒ©ã‚¹è¨­è¨ˆ

### 9.1 ã‚¯ãƒ©ã‚¹å›³

```
com.tis.nablarch.mcp.tools
â””â”€â”€ RecommendPatternTool
    â”œâ”€â”€ recommend(requirement, appType, constraints, maxResults): String
    â”œâ”€â”€ analyzeRequirement(requirement): AnalyzedRequirement
    â”œâ”€â”€ collectCandidates(analyzed, appType): List<PatternCandidate>
    â”œâ”€â”€ scorePattern(candidate, analyzed, appType, constraints): ScoredPattern
    â””â”€â”€ generateRanking(scored, maxResults): String

com.tis.nablarch.mcp.tools.pattern
â”œâ”€â”€ RequirementAnalyzer
â”œâ”€â”€ PatternScorer
â”œâ”€â”€ RankingGenerator
â””â”€â”€ model/
    â”œâ”€â”€ AnalyzedRequirement
    â”œâ”€â”€ PatternCandidate
    â”œâ”€â”€ ScoredPattern
    â””â”€â”€ Rationale
```

### 9.2 Toolç™»éŒ²

```java
@Component
public class RecommendPatternTool {

    @Tool(description = "Recommends Nablarch design patterns based on requirements.")
    public String recommend(
            @ToolParam(description = "Natural language requirement") String requirement,
            @ToolParam(description = "Application type", required = false) String appType,
            @ToolParam(description = "Additional constraints", required = false) List<String> constraints,
            @ToolParam(description = "Max results (1-11)", required = false) Integer maxResults) {
        // å®Ÿè£…
    }
}
```

---

## 10. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

| ã‚¨ãƒ©ãƒ¼æ¡ä»¶ | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | å¯¾å‡¦ |
|-----------|----------------|------|
| requirementãŒç©º | "ã‚¨ãƒ©ãƒ¼: è¦ä»¶ãƒ†ã‚­ã‚¹ãƒˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“" | å³åº§ã«ã‚¨ãƒ©ãƒ¼è¿”å´ |
| requirementãŒ10æ–‡å­—æœªæº€ | "ã‚¨ãƒ©ãƒ¼: è¦ä»¶ãƒ†ã‚­ã‚¹ãƒˆãŒçŸ­ã™ãã¾ã™" | å³åº§ã«ã‚¨ãƒ©ãƒ¼è¿”å´ |
| app_typeãŒä¸æ­£å€¤ | "ã‚¨ãƒ©ãƒ¼: ä¸æ˜ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—" | å³åº§ã«ã‚¨ãƒ©ãƒ¼è¿”å´ |
| è©²å½“ãƒ‘ã‚¿ãƒ¼ãƒ³ãªã— | "æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ" | ç©ºçµæœã‚’è¿”å´ |
| RAGæ¤œç´¢å¤±æ•— | Phase 1ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ | å‡¦ç†ç¶™ç¶š |

---

## 11. è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

```yaml
nablarch:
  mcp:
    tools:
      recommend-pattern:
        scoring:
          phase1:
            keyword-weight: 0.40
            category-weight: 0.25
            app-type-weight: 0.20
            constraint-weight: 0.15
          phase2:
            keyword-weight: 0.25
            category-weight: 0.20
            app-type-weight: 0.15
            constraint-weight: 0.15
            semantic-weight: 0.25
        default-max-results: 3
        min-score-threshold: 0.20
```
